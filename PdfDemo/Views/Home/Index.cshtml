@using PdfDemo
@using PdfDemo.Model
@model MaxAuditViewModel
@{
    Layout = null;

}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Branch Details</title>

</head>
<body>
    @using (Html.BeginForm("Search", "Home", FormMethod.Post))
    {
        <div style="width:100%;padding:10px;">
            <div class="PageHeaderSection" style="height:100%;position:unset;">
                <div class="card">
                    <div class="card-body bg-info text-white"><h4>Search</h4></div>
                </div>
                <div class="card-body">

                    <div class="form-group">

                        <div class="row">
                            <div class="col-md-3">
                                <label for="Company">Company</label>
                                @Html.DropDownListFor(model => model.CurrentCompany, Model.Companies as List<SelectListItem>, "Select Company", new { @class = "form-control" })
                            </div>
                            <div class="col-md-3">
                                <label for="Location">Location</label>
                                @Html.DropDownListFor(model => model.CurrentLocation, Model.Locations as List<SelectListItem>, "Select Location", new { @class = "form-control" })
                            </div>
                            <div class="col-md-2">
                                <label for="FromDate">From Date</label>
                                @Html.EditorFor(model => model.FromDate, new { htmlAttributes = new { @class = "form-control", @readonly = "true" } })
                            </div>
                            <div class="col-md-2">
                                <label for="ToDate">To Date</label>
                                @Html.EditorFor(model => model.ToDate, new { htmlAttributes = new { @class = "form-control", @readonly = "true" } })
                            </div>
                            <div class="col-md-2">
                                <button type="submit" class="btn btn-primary SubmitButton">View Audit Branch details</button>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
            <div class="BodyHeaderSection">
                <div class="card">
                    <div class="card-body bg-info text-white bodyHeaderContent"><h4>Branch Details</h4></div>
                </div>
                <div style="min-width:100%;overflow:auto;height:380px;padding-top:10px;">
                    <table id="gvBranchDetails" class="table-bordered">

                        <tr style="background-color:lightblue;color:black;font-family:Arial;font-size:11px;font-weight:bold;">
                            <th class="IndexColumn1 text-center">
                                @Html.DisplayNameFor(model => model.CurrentBranch.SerialNumber)
                            </th>
                            <th class="IndexColumn2 text-center">
                                @Html.DisplayNameFor(model => model.CurrentBranch.BranchCode)
                            </th>
                            <th class="IndexColumn3 text-center">
                                @Html.DisplayNameFor(model => model.CurrentBranch.BranchName)
                            </th>
                            <th class="text-center IndexColumn4">
                                @Html.DisplayNameFor(model => model.CurrentBranch.AuditTime)
                            </th>
                            <th class="text-center IndexColumn5"></th>
                        </tr>


                        @if (Model.BranchDetails == null || @Model.BranchDetails.Count <= 0)
                        {
                            <tr style="min-width:100%;"><td colspan="5">No records found</td></tr>
                        }
                        else
                        {
                            foreach (var item in Model.BranchDetails)
                            {
                                <tr>
                                    <td class="text-center">
                                        @Html.DisplayFor(modelItem => item.SerialNumber)
                                    </td>
                                    <td class="text-center">
                                        @Html.DisplayFor(modelItem => item.BranchCode)
                                    </td>
                                    <td class="text-center">
                                        @Html.DisplayFor(modelItem => item.BranchName)
                                    </td>
                                    <td class="text-center">
                                        @Html.DisplayFor(modelItem => item.AuditTime)
                                    </td>
                                    <td class="text-center">
                                        @Html.ActionLink("View Audit Report", "Details", new { Branch = item.BranchCode, AuditDate = item.AuditTime, Location = item.LocationCode }) |
                                    </td>
                                </tr>

                            }
                        }

                    </table>
                </div>
            </div>
        </div>
    }
    <link rel="stylesheet" href="~/Content/bootstrap.css" />
    <link rel="stylesheet" href="~/Content/code.jquery.com_ui_1.11.4_themes_smoothness_jquery-ui.css" />
    <link rel="stylesheet" href="~/Content/MaxLifeStyleSheet.css" />

    <script src="~/Scripts/jquery-3.4.1.min.js"></script>
    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Scripts/jquery-ui-1.11.4.min.js"></script>

    <script>
        $("#CurrentCompany").change(function () {
            var CompanyCode = $(this).val();
            $.ajax({
                cache: false,
                type: "POST",
                url: '@Url.Action("FetchLocations", "Home")',
                data: { "CompanyCode": CompanyCode },
                success: function (json, textStatus) {
                    $("#CurrentLocation").empty();
                    json = json || {};
                    $("#CurrentLocation").append('<option>Select Location </option>');

                    for (var i = 0; i < json.length; i++) {
                        $("#CurrentLocation").append('<option value="' + json[i].Value + '">' + json[i].Text + '</option>');
                    }
                    $("#ddlDesig").prop("disabled", false);
                },
                error: function () {
                    alert("Data Not Found");
                }
            });
        });
        $(document).ready(function () {
            $('input[type=datetime').datepicker(
            {
                changeMonth: true,
                changeYear: true,
                dateFormat: 'dd-M-yy',
                maxDate: new Date()


            })
        });

    </script>
</body>

</html>
